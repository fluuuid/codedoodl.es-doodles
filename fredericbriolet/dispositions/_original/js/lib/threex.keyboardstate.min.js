var THREEx=THREEx||{};THREEx.KeyboardState=function(e){this.domElement=e||document,this.keyCodes={},this.modifiers={};var t=this;this._onKeyDown=function(e){t._onKeyChange(e)},this._onKeyUp=function(e){t._onKeyChange(e)},this.domElement.addEventListener("keydown",this._onKeyDown,!1),this.domElement.addEventListener("keyup",this._onKeyUp,!1),this._onBlur=function(){for(var e in t.keyCodes)t.keyCodes[e]=!1;for(var e in t.modifiers)t.modifiers[e]=!1},window.addEventListener("blur",this._onBlur,!1)},THREEx.KeyboardState.prototype.destroy=function(){this.domElement.removeEventListener("keydown",this._onKeyDown,!1),this.domElement.removeEventListener("keyup",this._onKeyUp,!1),window.removeEventListener("blur",this._onBlur,!1)},THREEx.KeyboardState.MODIFIERS=["shift","ctrl","alt","meta"],THREEx.KeyboardState.ALIAS={left:37,up:38,right:39,down:40,space:32,pageup:33,pagedown:34,tab:9,escape:27},THREEx.KeyboardState.prototype._onKeyChange=function(e){var t=e.keyCode,o="keydown"===e.type?!0:!1;this.keyCodes[t]=o,this.modifiers.shift=e.shiftKey,this.modifiers.ctrl=e.ctrlKey,this.modifiers.alt=e.altKey,this.modifiers.meta=e.metaKey},THREEx.KeyboardState.prototype.pressed=function(e){for(var t=e.split("+"),o=0;o<t.length;o++){var i=t[o],n=!1;if(n=-1!==THREEx.KeyboardState.MODIFIERS.indexOf(i)?this.modifiers[i]:-1!=Object.keys(THREEx.KeyboardState.ALIAS).indexOf(i)?this.keyCodes[THREEx.KeyboardState.ALIAS[i]]:this.keyCodes[i.toUpperCase().charCodeAt(0)],!n)return!1}return!0},THREEx.KeyboardState.prototype.eventMatches=function(e,t){for(var o=THREEx.KeyboardState.ALIAS,i=Object.keys(o),n=t.split("+"),r=0;r<n.length;r++){var s=n[r],a=!1;if("shift"===s?a=e.shiftKey?!0:!1:"ctrl"===s?a=e.ctrlKey?!0:!1:"alt"===s?a=e.altKey?!0:!1:"meta"===s?a=e.metaKey?!0:!1:-1!==i.indexOf(s)?a=e.keyCode===o[s]?!0:!1:e.keyCode===s.toUpperCase().charCodeAt(0)&&(a=!0),!a)return!1}return!0};